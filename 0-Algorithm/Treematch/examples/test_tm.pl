#!/usr/bin/perl -w
use File::Basename;



my $color_enable = eval
{
  require Term::ANSIColor;
  Term::ANSIColor->import();
  1;
};

# compute the  example directory to manipulate only relative path
$path = dirname($0);

if ($#ARGV==0){
   $mapping = $ARGV[0];
}else{
   $src = `which mapping`;
   if ($src){
      $mapping = $src;
      chomp $mapping;
      $mapping2 = "$path/../src/treematch/mapping";
      if(-e $mapping2){
	 if((stat $mapping2)[9] > (stat $mapping)[9]){
	   $mapping = $mapping2;
	}
       }
   }else{
      $mapping  = "$path/../src/treematch/mapping";
   }
}

have_scotch();

unless(-e $mapping){
   die"Error: unable to find the mapping executable ($mapping).\nBe sure you that it is in your path or pass it in the command line of $0 (e.g. $0 /usr/bin/mapping)\n";
}

$path = "" if ($path eq "./");


$ex1  = "$mapping -t $path/topologies/128.tgt -c $path/com_patterns/128.mat -d";
$ex2  = "$mapping -t $path/topologies/128.tgt -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind -g -d";
$ex3  = "$mapping -x $path/topologies/64.xml -c $path/com_patterns/64.mat -d -n";
$ex3l  = "$mapping -x $path/topologies/64.xml -c $path/com_patterns/64.mat -d";
$ex4  = "$mapping -x $path/topologies/64.xml  -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind -g -d -n";
$ex4l  = "$mapping -x $path/topologies/64.xml  -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind -g -d";
$ex5  = "$mapping -t $path/topologies/512.tgt -c $path/com_patterns/512.mat -d -g";
$ex6  = "$mapping -t $path/topologies/1024.tgt -c $path/com_patterns/512.mat -b $path/binding_constraints/512.bind -g -d";
$ex1o = "$mapping -t $path/topologies/128.tgt -c $path/com_patterns/128.mat ";
$ex2o = "$mapping -t $path/topologies/128.tgt -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind -g";
$ex3o = "$mapping -x $path/topologies/64.xml -c $path/com_patterns/64.mat -n ";
$ex4o = "$mapping -x $path/topologies/64.xml  -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind -g -n";
$ex5o = "$mapping -t $path/topologies/512.tgt -c $path/com_patterns/512.mat";
$ex6o = "$mapping -t $path/topologies/1024.tgt -c $path/com_patterns/512.mat -b $path/binding_constraints/512.bind -g";
$ex7  = "$mapping -t $path/topologies/3375.tgt -c $path/com_patterns/3375.mat";
$ex8  = "$mapping -t $path/topologies/900.tgt -c $path/com_patterns/512.mat";
$ex9  = "$mapping -t $path/topologies/128.tgt -c $path/com_patterns/16.mat";
$ex10 = "$mapping -x $path/topologies/64.xml  -c $path/com_patterns/16.mat -n";
$ex11 = "$mapping -t $path/topologies/32.tgt -c $path/com_patterns/128.mat -o4";
$ex12 = "$mapping -x $path/topologies/64.xml -c $path/com_patterns/64.mat -d -o2 -n";
$ex13 = "$mapping -x $path/topologies/64.xml -c $path/com_patterns/64.mat -b $path/binding_constraints/16.bind -o4 -g -n";
$ex14 = "$mapping -t $path/topologies/1024.tgt -c $path/com_patterns/128.mat -b $path/binding_constraints/16.bind -o9 -g";
$ex15 = "$mapping -t $path/topologies/128.tgt -c $path/com_patterns/32.mat -b $path/binding_constraints/8.bind -o4 -g";
$ex16 = "$mapping -t $path/topologies/16.tgt -c $path/com_patterns/32.mat -b $path/binding_constraints/8.bind -o4 -g";
$ex1s = "$mapping -t $path/topologies/m2D_20x20.tgt -c $path/com_patterns/128.mat";
$ex2s = "$mapping -t $path/topologies/m2D_8x8.tgt -c $path/com_patterns/64.mat";
$ex3s = "$mapping -t $path/topologies/t3D_8x4x8.tgt -c $path/com_patterns/256.mat";
$ex4s = "$mapping -t $path/topologies/hypercude_10.tgt -c $path/com_patterns/64.mat";   
$ex5s = "$mapping -t $path/topologies/deco.tgt -c $path/com_patterns/8.mat";
$ex1sb = "$mapping -t $path/topologies/m2D_10x10.tgt -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind";
#$ex2sb = "$mapping -t $path/topologies/m2D_30x30.tgt -c $path/com_patterns/512.0.5.mat -b $path/binding_constraints/512.bind";
$ex3sb = "$mapping -t $path/topologies/hypercude_10.tgt -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind";
$ex4sb = "$mapping -t $path/topologies/t3D_8x4x8.tgt -c $path/com_patterns/16.mat -b $path/binding_constraints/16.bind";
#$ex5sb = "$mapping -t $path/topologies/hypercude_10.tgt -c $path/com_patterns/512.0.5.mat -b $path/binding_constraints/512.bind";





$res1 = "TreeMatch: 0,8,16,24,32,10,40,48,56,64,34,72,80,88,50,96,18,104,52,97,20,54,58,4,12,82,66,112,100,36,38,84,49,108,92,33,76,44,116,22,110,106,57,55,45,46,120,102,93,89,68,74,122,9,124,35,90,118,105,78,70,60,26,13,98,81,69,27,103,6,25,123,107,114,1,99,19,28,62,63,117,7,109,30,86,87,5,17,47,29,65,2,126,77,101,111,11,73,83,94,95,14,41,21,42,115,59,37,75,53,39,3,125,15,121,61,71,43,85,91,113,51,119,23,127,79,67,31";
$res2 = "TreeMatch: 35,30,16,10,8,17,33,27,32,12,2,34,23,29,26,31";
$res3 = "TreeMatch: 0,4,8,16,24,32,40,1,17,9,28,48,56,33,2,41,60,49,57,44,12,5,21,7,18,62,13,61,52,25,29,63,3,50,36,26,6,45,27,34,54,53,19,42,47,43,31,46,38,35,10,11,59,58,23,30,37,20,51,39,14,22,55,15";
$res3l = "TreeMatch: 0,2,8,16,24,32,40,4,20,12,26,48,56,36,1,44,58,52,60,42,10,6,22,7,17,59,14,62,50,28,30,63,5,49,34,25,3,46,29,33,51,54,21,41,47,45,31,43,35,37,9,13,61,57,23,27,38,18,53,39,11,19,55,15";
$res4 = "TreeMatch: 35,26,17,8,10,2,34,31,32,12,16,33,27,23,29,30";
$res4l = "TreeMatch: 35,27,16,10,8,2,33,31,32,12,23,34,29,17,30,26";
$res5 = "TreeMatch: 490,506,170,146,42,100,342,10,478,440,86,116,190,416,254,268,218,452,87,80,328,456,476,226,96,394,101,40,390,316,156,300,460,160,214,284,50,322,414,54,448,234,104,457,122,406,282,252,323,164,2,286,168,346,500,468,418,142,55,258,4,474,382,106,84,248,446,304,152,240,434,126,162,30,280,8,138,66,88,262,370,178,148,110,308,202,230,486,288,438,143,82,171,256,326,263,504,60,278,150,130,309,32,174,283,210,140,464,424,318,46,153,501,317,61,56,444,154,398,274,70,36,412,253,238,244,124,120,200,136,340,380,298,343,402,505,338,281,386,502,399,74,275,188,482,439,372,396,266,121,442,64,246,78,94,408,324,384,348,38,269,480,92,93,462,123,239,158,76,290,255,112,182,134,419,186,216,137,264,139,215,71,37,196,305,222,149,128,24,236,410,426,344,0,228,368,33,129,443,366,34,354,458,224,184,388,250,345,14,175,360,378,488,90,194,302,125,251,144,470,223,436,472,373,26,265,292,72,387,276,18,314,231,301,102,176,294,232,473,484,355,404,198,437,208,498,44,334,180,445,420,48,247,272,20,341,79,65,489,91,409,217,28,155,432,295,356,494,242,16,203,496,249,364,131,499,479,68,358,350,166,9,197,103,243,335,267,204,77,273,3,428,312,466,332,108,211,260,467,67,19,89,6,51,491,430,391,52,172,422,209,503,261,165,177,206,508,201,22,313,381,507,21,41,141,113,159,118,365,23,185,12,510,374,306,287,192,483,193,395,145,151,227,29,336,329,371,339,411,270,415,105,277,469,509,433,47,337,465,117,475,293,359,471,296,169,57,259,362,291,403,310,492,427,493,429,447,461,83,75,179,383,15,39,95,511,111,69,279,303,389,257,421,311,485,58,400,407,49,43,13,173,53,495,450,225,325,454,167,320,189,347,481,385,187,477,62,327,161,107,455,376,81,45,285,245,441,413,114,459,63,85,377,119,487,321,157,212,98,453,35,497,351,361,319,73,405,357,423,99,369,352,330,220,307,401,183,135,435,297,7,132,451,219,17,195,425,27,449,392,59,147,205,109,379,363,191,199,233,163,1,375,333,241,11,289,5,235,315,133,463,31,431,25,393,229,221,271,367,237,349,115,181,353,127,97,331,207,397,299,213,417";
$res6 = "TreeMatch: 269,260,743,538,232,174,452,171,283,348,144,224,114,280,732,502,5,309,145,150,395,315,287,126,173,310,175,233,367,509,731,396,319,704,689,497,195,428,291,193,308,62,199,314,218,328,473,25,429,110,200,496,13,392,355,376,281,59,192,436,207,286,385,198,147,26,345,413,28,81,274,167,108,170,475,168,61,239,253,434,393,523,529,197,409,55,101,357,462,276,58,148,14,438,423,435,263,155,403,514,513,408,211,73,472,20,57,383,372,511,234,29,354,508,154,152,347,30,306,491,236,212,292,24,687,109,165,217,53,60,454,386,397,453,322,262,450,474,343,353,307,180,490,113,359,277,489,304,500,216,351,235,104,128,254,295,420,340,492,214,503,358,245,244,317,219,56,40,131,460,45,226,526,627,282,119,6,63,501,76,17,237,213,519,412,2,528,512,172,78,293,375,494,203,103,488,210,515,350,469,209,480,313,34,116,365,46,495,153,72,468,391,271,251,38,493,164,47,537,301,3,279,284,451,157,477,458,182,342,401,190,505,100,465,159,520,456,79,285,356,481,326,516,278,23,352,179,467,524,346,349,194,105,407,141,455,129,177,270,250,294,7,156,42,273,457,485,267,83,189,54,288,44,470,517,289,344,176,487,464,106,169,518,158,82,466,476,51,130,406,201,371,507,380,510,196,21,432,381,238,191,252,205,185,268,370,366,184,74,264,88,290,433,111,521,48,256,52,188,506,387,261,140,183,77,227,41,230,471,187,117,135,259,504,414,478,37,374,531,311,536,633,127,133,404,394,402,405,368,479,369,186,400,377,257,272,178,427,382,225,265,459,486,300,425,12,132,437,426,461,323,411,266,373,321,339,324,318,149,181,522,384,134,215,247,258,229,208,431,424,364,439,325,410,336,202,320,327,228,204,223,75,231,305,302,35,421,296,107,430,112,415,337,341,118,331,221,422,85,138,297,390,151,222,463,80,335,338,136,312,220,146,416,139,362,417,86,16,255,298,249,363,418,419,482,248,768,484,330,163,483,70,66,0,71,329,527,535,275,67,160,532,303,115,142,39,361,162,299,333,166,539,50,143,69,65,124,530,8,84,161,15,11,22,241,10,206,9,64,533,316,242,360,243,332,102,1,36,18,19,49,137,525,122,246,240,120,125,334,121,123,534";
$res7="TreeMatch: 0,1,3,4,6,7,8,5,9,10,15,2,16,12,13,18,19,14,20,11,21,22,24,17,25,45,46,48,49,51,52,54,23,55,60,61,26,63,47,50,64,66,67,53,27,28,57,56,62,58,68,69,70,65,90,29,91,93,71,94,59,96,97,99,92,100,101,105,106,108,95,109,111,98,112,114,115,135,136,107,72,73,138,110,139,141,113,142,144,116,145,75,137,76,102,74,140,103,78,146,79,143,80,81,82,77,117,118,84,104,85,150,151,153,154,83,147,148,119,86,156,157,159,160,155,675,152,676,149,678,679,87,88,677,158,680,161,681,682,684,685,690,691,693,694,89,696,697,683,162,163,699,686,695,700,687,692,688,720,721,723,698,724,726,727,164,729,725,701,730,722,689,735,736,728,738,739,741,742,744,731,745,702,703,746,737,765,766,740,732,733,768,743,769,747,748,771,772,704,774,775,767,734,780,781,770,777,749,778,783,784,786,773,787,789,776,779,782,790,810,811,813,814,785,816,817,819,791,788,812,820,165,166,168,169,171,815,821,172,792,818,793,174,175,120,167,794,121,123,170,173,124,125,126,127,822,176,823,129,130,122,30,31,33,34,36,37,128,131,177,824,178,132,133,179,32,39,35,40,825,38,826,828,829,831,832,42,830,134,41,43,834,835,837,827,838,900,901,833,836,903,904,44,906,907,902,909,839,910,915,916,918,919,908,921,905,922,924,925,945,911,917,946,948,949,927,920,928,923,926,912,913,951,947,952,954,929,950,955,960,961,963,964,966,914,967,969,970,953,990,962,956,991,993,994,965,968,996,997,999,1000,1001,971,1005,992,1006,1008,1009,957,995,958,998,1011,1012,1014,1015,1035,1007,1036,1010,1038,1039,959,972,973,1002,1016,1013,1003,1041,1042,1044,1037,1045,705,1040,706,974,708,1043,1004,709,711,710,712,1047,1046,1048,707,714,715,1050,1051,1017,1018,717,718,713,1053,716,1049,1054,1056,1057,1055,1052,1059,1060,719,1019,1350,1351,1353,1061,1354,1062,1058,1063,1356,1357,1359,1360,1365,1352,1366,1368,1355,1064,1369,1362,1363,1358,1371,1372,1361,1374,1375,1370,930,1367,931,933,934,1364,936,937,1373,939,940,1376,1020,1021,1023,932,1024,1026,1027,935,1029,1030,938,941,1377,1378,750,1025,1022,1028,1379,751,753,754,756,757,1031,759,760,1395,1396,752,1398,1399,755,942,943,1401,1402,758,1032,1033,761,1400,1404,1397,1405,1410,1411,944,1413,1414,1416,1034,1403,1412,1417,762,763,1406,1419,1420,1440,1415,1441,1443,1444,1407,764,1418,1408,1446,1447,1449,1421,1450,1455,1442,1456,1451,1445,1458,1409,1459,1448,1422,1423,1460,1461,1462,1464,1457,1465,1485,1486,1488,1489,1491,1492,1424,1463,1494,1466,1495,1500,1501,1452,1487,1453,1503,1493,1490,1504,1506,1507,1508,1509,1496,1502,1505,1510,1454,1467,1468,795,796,798,799,801,802,804,1511,805,1469,800,797,840,841,1512,1513,1497,1498,803,843,844,806,842,846,847,849,850,1470,1514,1471,1473,1474,1499,848,1475,845,851,1476,1477,852,853,1479,1480,1478,1472,1065,1066,807,808,1068,1069,1071,854,1072,1481,1074,1067,809,1075,2025,2026,1070,1076,1073,1482,1483,2028,2029,2027,2030,1077,1078,2031,2032,2034,2035,1484,975,976,978,979,981,982,1079,2037,2033,2038,984,985,2036,2040,2041,977,980,2043,2044,983,2039,2046,2047,2049,2050,2070,2071,986,2042,2073,2074,987,988,2045,2048,2052,2053,2076,2051,2077,2072,2075,2079,2080,2085,2086,2081,2088,989,2089,2054,2091,2078,2092,2094,2095,2115,2116,2118,2087,2119,2121,2122,2090,2124,2125,2093,2096,2117,2055,2056,2058,2059,2082,2083,2120,2061,2123,2062,2126,2064,2065,2130,2131,2057,2060,2133,2084,2063,2134,2097,2098,2067,2068,2135,2066,2127,2128,2132,2099,2136,2137,2139,2140,180,181,183,2069,2138,182,2129,184,186,187,189,2141,190,195,196,198,199,188,185,191,201,202,204,205,200,207,208,2142,197,2143,1380,1381,1383,203,1384,206,1386,1387,209,1382,192,2144,193,1389,1388,194,1390,2160,2161,1385,2163,2164,2166,2167,1392,1393,1394,1391,2169,2162,2170,2175,2176,2165,2168,2178,2179,2181,2182,2184,2185,2183,2171,1515,1516,2177,1518,1519,2180,1521,1522,1520,1523,2186,1524,1525,2172,1517,2173,2174,2700,2701,2703,2704,2187,1526,2188,2706,2707,2709,2702,2710,1425,1426,1428,1429,2705,1431,2189,1432,2708,1434,1435,1427,1437,2711,1438,1430,1527,1528,2715,1436,2716,1433,2712,2713,2718,2719,2721,1439,2722,2724,1529,2714,2725,2717,2745,2746,2748,2720,2749,2751,2752,2754,2755,2723,2760,2761,2726,2747,2763,2764,2750,2727,2756,2728,2766,2753,2767,2769,2770,2729,2790,2762,2765,2791,2772,2773,2768,2757,2771,2758,2793,2794,2796,2797,2799,2792,2774,2800,2805,2806,2795,2759,2808,2809,2811,2812,2814,2798,2815,2835,2801,2836,2838,2807,2839,2841,2842,2810,2844,2813,2845,2850,2816,2851,2840,2837,2853,2854,2846,2802,2803,2843,2856,2857,2859,2860,2855,2852,2817,2818,2925,2926,2928,2804,2858,2929,2847,2848,2861,2819,2931,2932,2934,2935,2927,2775,2930,2776,2778,2779,2849,2781,2777,2782,2936,2933,2784,2785,2862,2863,2190,2780,2191,2783,2193,2194,2196,2197,2786,2199,2200,2940,2941,2864,2943,2192,2944,2937,2198,2195,2938,2946,2947,2201,2949,2950,2945,2942,2100,2101,2939,2787,2788,2202,2203,2103,2104,2948,2102,2106,2951,2789,2107,2109,2110,210,211,2112,2113,2204,2111,2105,212,213,2108,214,2114,2952,2953,216,217,219,220,2970,215,2971,221,2973,2974,2954,218,2976,2977,2979,2980,2985,2986,2988,2972,2989,2991,2975,2992,2978,2994,2995,3015,2987,2981,3016,222,223,2982,2990,2983,3018,2993,3019,3021,3022,2996,3024,3017,3025,3023,224,3030,3031,2984,3020,3033,3034,3036,3037,3039,3040,3032,3026,2997,2998,2145,3038,3035,2146,2148,2149,3027,3028,3041,2151,2147,2152,2999,2154,2155,3060,3061,2150,3063,3064,3066,3029,2156,2153,3067,3069,3070,3071,3075,3076,3042,3062,3043,3065,3072,3077,3068,3073,3078,3079,2157,2158,3081,3082,3084,3044,3085,3086,3074,3080,2159,225,226,228,229,3083,231,232,234,230,227,235,240,241,243,244,246,247,249,233,250,1530,1531,236,242,3087,3088,245,1532,1533,1534,1536,248,1537,251,252,253,1539,1540,2865,3089,2866,237,1535,254,2867,238,1538,1542,1543,2868,2869,2871,1541,2872,2874,2875,2870,239,1545,1546,1548,1544,1549,2873,1551,1552,1554,1555,2876,2877,1547,2878,1550,2730,2731,2733,2734,2879,2736,1553,2737,2732,1556,2739,2740,855,856,858,859,861,2735,862,1557,2738,2741,1558,864,865,857,1560,1561,1563,1564,860,1566,863,1567,1569,1559,1570,866,867,868,1562,2742,2743,1572,1573,1565,870,1568,871,1571,873,874,869,876,877,879,2744,880,1574,270,271,875,272,872,878,881,273,274,276,277,279,280,2820,2821,282,283,2823,275,278,2824,2826,2827,281,2829,2830,2828,2822,882,883,284,285,286,2825,2831,288,289,291,292,294,295,315,884,287,316,318,319,321,290,322,293,324,325,296,2832,2833,297,326,317,2834,320,298,330,331,323,333,334,336,335,299,332,337,339,340,2955,2956,2958,2959,2961,2962,327,338,328,341,2964,2965,2957,360,361,342,2960,343,2966,362,2963,363,329,364,366,367,369,370,344,375,376,378,379,365,368,381,382,377,371,384,385,2967,2968,300,380,301,303,2969,304,383,387,388,386,389,302,306,305,307,309,310,372,373,312,313,2250,2251,2253,308,2254,2256,2257,311,2259,374,2260,2252,314,2265,2266,2268,2261,2255,2269,2258,2271,2272,2274,2275,3045,3046,2273,2267,3048,2270,3049,3051,3052,2262,2263,3054,2276,3047,3055,255,256,3050,3053,258,259,3057,257,3056,3058,2264,2277,2278,261,2279,262,264,260,265,3000,3001,3003,3059,3004,3006,3007,263,3009,3002,3010,266,1080,1081,3008,267,268,3012,3005,3013,1083,1084,1086,3011,1087,1082,1089,1090,269,3090,3091,3014,1085,3093,3094,3096,3097,1088,3099,3100,1095,1096,1091,1098,3095,3092,1099,1101,3098,1102,1104,1105,2295,2296,3101,2298,1097,1106,2299,1092,1100,1093,1103,2301,2302,2304,2305,2300,2297,2310,2311,2313,2314,2303,1094,3102,3103,2316,2312,3104,2317,2306,2319,2320,1110,1111,2315,1113,1114,1107,1108,2318,1116,1117,1119,2321,1112,1115,1120,1121,2322,2323,1122,1123,2307,1109,2308,1118,885,886,888,889,2324,891,892,894,895,1124,2309,2340,887,2341,890,2343,2344,2346,2347,2349,893,2350,896,897,898,2342,2355,2356,2358,2345,2359,2361,2362,2348,2351,2364,2365,2880,2360,899,2881,2357,2883,2884,2367,2363,2368,2366,2352,2353,2886,2887,2882,2889,2890,2895,2896,2885,2898,2369,2899,2354,2901,2902,2888,2904,2905,2897,2900,2891,2385,2386,2907,2908,2388,2389,2391,2392,2903,2909,2387,2906,2892,2390,2893,2394,2395,2400,2401,2403,2404,2396,2406,2393,2894,2407,2397,2398,2409,2410,2402,1575,1576,1578,2405,1579,1581,2408,1582,2399,1580,1583,1584,2411,1585,1590,1577,1591,1593,1594,2412,2413,1596,1597,1599,1600,1586,390,1592,391,393,394,1595,396,2414,397,399,400,1598,1601,1587,392,1588,1602,1603,395,398,1620,1621,1623,401,1624,402,403,1626,1627,1589,1629,1604,1630,1635,1622,1636,1638,1625,1639,1641,1642,404,1644,1628,1645,345,1631,1640,346,1637,348,349,1632,1633,351,352,1643,1646,354,355,2205,347,2206,2208,350,2209,2211,2210,1634,2212,353,1647,356,1648,2214,2207,2215,2220,2221,2223,2224,2213,2226,1649,2227,2229,2230,357,358,2216,1665,1666,2222,1668,2225,1669,2228,1671,1672,2231,359,1674,1675,1670,2217,1673,2218,1667,1680,1681,1683,1684,1686,1687,1677,1676,1685,2219,1678,1689,1690,2280,1682,2281,2232,2233,1688,2283,2284,1679,1691,2286,2287,2282,2289,2290,1710,1711,2234,1713,1714,2292,2291,2285,2293,2288,1716,1717,1719,1720,1692,1715,1712,1693,2910,2911,2913,1718,2294,1694,2912,2914,1722,1721,2915,1723,2916,2917,2919,2920,1725,1726,1728,1727,2918,1724,2921,1729,1731,1732,1734,1735,2415,2416,2418,2419,2922,2923,1730,2421,2422,1733,2423,2424,1736,2425,2325,2417,2420,2326,2924,2328,2329,2331,2332,2334,2335,2426,2235,2236,2327,1737,1738,2336,2238,2330,2239,2333,2240,2241,2242,1739,2237,2427,2428,2337,2429,2338,2244,2245,2247,2243,2248,2475,2476,2339,2478,2246,2479,2481,2482,2484,2477,2485,2370,2249,2371,2373,2374,2376,2377,2480,2379,2483,2380,2490,2375,2486,2372,2491,2493,2494,2496,2497,2498,2378,2381,2495,2499,2500,1650,1651,2492,2487,2488,1653,1654,1656,1657,1659,1660,2501,1605,1652,1606,1662,1663,2489,2382,2383,1655,1658,2502,2503,1608,1661,1609,1611,1612,1607,2384,1614,1664,2504,1615,2520,2521,2523,2522,1610,2524,2526,2527,1613,2529,2530,2535,1616,2536,2525,1617,2528,1618,2538,2539,2541,2542,2544,2545,2531,2565,2546,2537,2543,1619,2566,2568,2540,2569,2571,2572,2574,2575,2580,2581,2567,2532,2533,2570,2583,2584,2586,2573,2587,2547,2548,2576,2582,2589,2585,2590,2534,2577,2578,2610,2611,2588,2591,2612,2549,2613,2614,2616,2617,2619,2579,2620,2625,2626,2628,2629,2631,2615,2632,2618,2592,2593,2634,2635,2621,2633,1800,2627,2630,1801,2622,2623,1803,1804,2637,2624,2594,2638,1806,2636,1807,1802,1809,1805,1810,1815,1816,1818,1819,2639,1821,1822,1824,1808,1825,1811,1845,1846,1823,1817,1847,1820,1848,1849,1827,1828,1851,1852,1812,1826,1813,1854,1855,2550,1850,1829,2551,1857,1858,1853,2553,2554,2556,2557,1814,2559,2560,1856,1695,2552,1696,1859,1698,2555,1699,1701,2558,1702,2561,1704,1705,1860,1861,1700,2562,1697,2563,1707,1708,1863,1864,1703,1706,1866,1867,1869,1709,1862,1870,2564,3105,3106,3108,3109,1865,1872,1871,1873,1868,3111,3112,3114,3115,3117,1874,3107,3113,3110,3118,1740,1741,1743,1744,1746,1747,1745,3116,1749,3119,1750,3120,3121,1742,3123,3124,1752,3125,1753,1748,3126,1751,3127,3129,3122,3130,1890,1891,1893,3128,1894,1896,1754,1897,1899,1900,1830,1831,3131,1892,1833,1901,1834,1895,1836,1898,1837,1839,1840,3132,3133,1902,1835,1832,1903,1905,1906,1838,1907,1908,3134,1909,1841,1911,1912,1914,1904,1915,1935,1936,1938,1939,1910,1941,1942,1917,1913,1918,1916,1944,1945,1842,1937,1843,1950,1919,1940,1951,1953,1943,1954,1956,1946,1955,1844,1957,1959,1960,1125,1952,1126,1128,1129,1131,1958,1132,1134,1135,2595,2596,1961,1127,2598,2599,1947,1130,1948,2601,2602,1133,2604,2605,1136,1140,1141,2597,1962,1963,2600,1949,1142,2606,2603,1143,1144,1146,1147,1137,1138,1964,1149,1150,1170,1171,1173,1145,1148,1174,1176,1177,1139,1179,1151,1180,2505,1172,2506,2508,2509,1175,2607,2608,2511,1178,2512,2514,1181,2515,2510,2609,2507,1185,1186,1188,2513,1189,1152,1153,1191,1192,1194,2516,1195,1193,1187,2517,2518,1182,1190,1183,1196,1154,2519,1215,1216,1218,1219,1221,1222,1224,1225,1184,1965,1966,1968,1969,1217,1220,1971,1972,1974,1223,1975,1197,1198,1226,1967,1230,1231,1970,1233,1234,1236,1237,1973,1976,1232,1239,1199,1240,2640,2641,1227,1228,2643,2644,1235,1977,1238,1978,2646,2642,1241,2647,2649,2650,1920,1921,1229,1923,2645,1924,1926,2651,1979,2648,1927,1242,1243,1929,1930,1922,405,406,1925,408,409,411,412,1928,2652,1244,2653,414,1931,415,410,1875,407,1876,1878,1879,1881,1882,413,2654,1884,1885,1880,416,420,421,1877,1932,1933,417,418,422,1883,423,424,426,1886,427,429,430,3150,1934,3151,419,425,3153,3154,1887,1888,3156,428,431,3157,3159,3160,3152,3165,3166,432,3155,433,3168,1889,3169,3167,434,3158,3171,3172,3161,3174,3175,3195,3196,3198,3199,3200,3201,3170,3173,3202,3162,3163,3176,3204,3203,3205,3197,3210,3211,3206,3164,3213,3214,3216,3217,3177,3178,3219,3220,2655,2656,3212,2658,2659,3215,3179,2661,3218,3221,2662,2664,2665,3135,3136,2657,3138,3139,2663,3207,2660,3208,3141,2666,3142,3144,3137,3145,2670,2671,3222,3223,3140,2673,2674,3209,2672,3146,3143,2676,2677,3147,3148,2679,2680,2667,3224,2668,2675,1980,1981,2678,1983,1984,3149,1986,1987,1982,2669,2681,1989,1990,1985,3180,3181,3183,3184,3186,3187,1988,2682,1991,2683,3189,3190,3185,1155,3182,1156,1158,1159,3188,1161,1162,3191,1164,2684,1157,1165,1992,1993,1995,1996,1998,1999,1160,2000,2001,1163,2002,1166,2004,2005,1994,3192,3193,1997,1260,1261,1263,1264,1266,2003,1267,2006,1269,1270,3194,1167,1168,1275,1262,1276,1278,1279,1265,1268,2007,2008,1271,1281,1169,1277,2009,1282,1284,1285,3240,1280,3241,3243,3244,3246,3247,3249,3245,1283,3250,1286,1272,3248,1273,3242,2685,2686,2688,1274,2689,2691,3251,2692,1287,1288,3252,3253,2694,2695,2687,2690,3255,2693,3256,2696,3258,3254,3259,1289,3261,3262,3263,3264,3265,3285,3257,3286,3288,3289,2697,3260,2698,3266,3291,3292,3294,3295,3300,3301,3287,3303,3304,3290,3267,3268,2699,3293,3296,3306,3307,3309,3310,3297,3302,3298,3305,3311,1200,3299,1201,3269,3308,1203,1204,1206,1207,3312,3313,1209,1210,435,436,1202,438,439,1205,441,1208,442,444,3314,445,1211,2430,2431,2433,446,437,440,2434,2436,2437,2439,443,2440,1212,1213,2441,2445,2432,2446,2448,2435,2449,2451,2438,2452,2454,2455,1245,1214,1246,2447,1248,1249,2450,1250,447,448,2453,1251,1252,1247,2456,1254,1255,2457,2458,2442,2443,450,449,451,1253,453,454,456,1256,457,2459,452,459,2444,460,465,466,468,469,458,471,455,472,462,463,461,474,470,475,2010,467,2011,1257,1258,2013,476,473,464,2014,2016,2017,2019,2020,1305,1306,2012,2018,1259,1308,1309,2015,477,478,1307,1311,2021,1312,1314,1315,1316,1320,1321,1310,1323,1324,1326,479,1327,1329,1313,1330,1322,495,496,498,499,2022,2023,1325,501,1328,502,1331,1317,1318,497,504,505,1332,500,1333,510,511,2024,503,513,514,1319,516,517,519,506,520,2460,2461,1334,512,2463,2464,2466,2467,515,518,2469,521,2470,3225,3226,2462,3228,3229,2465,507,508,2471,522,2468,523,3231,3232,3227,3234,3235,3230,540,509,3236,541,543,544,3233,524,546,547,548,549,550,2472,542,551,2473,585,586,545,588,589,591,592,590,552,553,2474,587,594,595,3237,3238,555,556,593,558,559,561,554,562,564,596,565,566,3239,3270,3271,3273,557,563,3274,560,3276,3277,3279,3280,1290,1291,597,3272,3278,3275,598,1293,1294,1296,1295,1297,3281,567,568,1292,1299,1300,1755,599,1756,1758,1759,1298,3282,3283,569,1761,1762,1760,1764,1301,1765,1757,600,601,3284,603,1763,604,1302,1303,1767,1768,606,1766,607,609,602,610,605,1769,1335,1336,1338,1304,1339,1341,1342,608,1344,611,1345,1346,612,613,1347,1337,1340,1348,630,1343,631,633,634,636,637,614,639,640,645,632,1349,646,635,648,649,651,652,654,655,638,570,571,641,647,656,642,650,643,573,574,576,653,577,579,580,644,572,581,1770,1771,575,1773,578,1774,1776,1777,1779,1780,480,481,657,1775,1772,658,1781,659,482,1778,483,484,485,486,487,489,490,582,583,1785,1786,1788,1789,492,493,488,1782,491,1783,1791,584,1792,1787,494,1794,1790,1795,3330,1784,3331,3333,3334,3336,3337,1797,1793,1798,3339,3340,1796,3332,3315,3316,3318,3335,3319,3338,3321,3322,3324,1799,3325,615,616,3341,3317,618,619,3323,3320,621,622,3342,617,3343,3326,624,625,3345,3346,3348,620,3349,623,3327,3328,3351,3344,3352,3354,626,3355,3360,3361,3347,3350,3329,3363,3362,3364,3366,3367,3369,3353,3356,3370,525,3365,526,528,529,3368,627,628,3372,3373,531,3371,532,534,535,527,530,3357,3358,660,629,3374,661,663,533,664,666,667,536,669,537,3359,670,662,672,673,674,671,665,538,668,539";
$res1o = "TreeMatch: 0,64,96,72,32,66,40,80,16,8,34,112,48,24,82,88,98,56,84,89,100,86,18,4,68,50,10,120,92,36,38,52,81,60,28,33,116,44,124,102,62,58,17,87,45,46,104,94,29,25,12,114,106,65,108,35,26,126,57,118,14,20,74,69,90,49,13,75,95,6,73,107,59,122,1,91,99,76,22,23,125,7,61,78,54,55,5,97,47,77,9,2,110,117,93,63,67,113,51,30,31,70,41,101,42,123,19,37,115,85,39,3,109,71,105,21,15,43,53,27,121,83,127,103,111,119,11,79";
$res2o = "TreeMatch: 23,27,32,8,10,33,16,30,17,2,12,29,34,35,31,26";
$res3o = "TreeMatch: 0,4,8,16,32,24,40,1,17,9,36,48,56,25,2,41,60,49,57,44,12,5,21,7,18,62,13,61,52,33,37,63,3,50,28,34,6,45,35,26,54,53,19,42,47,43,39,46,30,27,10,11,59,58,23,38,29,20,51,31,14,22,55,15";
$res4o = "TreeMatch: 16,30,12,32,34,2,17,29,23,33,35,27,8,10,31,26";
$res5o = "TreeMatch: 122,26,466,402,242,220,350,194,110,112,150,172,422,96,494,292,426,76,151,144,368,8,108,442,216,66,221,240,6,340,484,356,12,496,478,300,178,282,38,182,72,458,184,9,138,86,298,492,283,500,130,302,464,362,60,92,98,454,183,258,132,106,318,186,148,488,118,272,480,504,18,142,498,214,296,192,450,250,152,262,378,410,404,190,276,434,446,54,304,22,455,146,467,256,286,263,24,204,326,406,386,277,224,470,299,474,452,88,40,342,246,481,61,341,205,200,116,482,70,322,254,228,36,493,462,508,140,136,432,448,348,316,354,351,82,25,346,297,2,62,71,234,323,420,50,23,380,68,290,137,114,248,510,238,158,32,284,0,364,230,293,48,156,157,14,139,463,486,236,306,495,168,414,390,99,418,424,449,288,451,479,255,229,396,273,430,405,384,208,460,34,42,360,128,444,376,225,385,115,334,226,266,10,440,416,4,490,361,198,471,328,314,120,154,394,358,141,491,400,94,431,20,104,381,210,289,308,232,3,324,162,338,447,357,222,408,310,456,105,52,267,84,398,21,472,58,244,374,412,117,100,176,511,320,164,349,239,249,121,155,33,425,212,483,16,311,268,126,506,160,435,56,489,332,387,59,111,252,270,366,502,193,397,223,507,375,291,436,237,321,131,44,336,90,372,188,475,260,91,251,163,153,134,179,123,46,7,180,468,102,473,63,261,501,409,438,28,433,166,337,317,27,165,241,453,169,487,174,333,167,417,196,30,382,274,303,392,51,393,67,401,407,443,213,344,369,379,347,35,294,39,185,325,93,29,17,247,345,89,173,107,309,271,95,352,465,201,259,330,307,83,278,124,43,125,45,119,13,147,235,411,319,199,231,159,31,191,253,327,359,5,257,101,279,53,202,80,87,177,243,197,469,181,127,74,441,285,78,503,280,421,363,49,1,419,109,206,287,497,187,79,312,145,245,301,509,113,37,170,11,207,149,313,175,55,281,485,476,218,77,227,57,367,329,343,233,85,269,103,219,377,264,370,428,275,81,415,391,19,353,135,388,75,427,161,395,41,211,73,64,203,403,437,189,315,331,423,399,457,499,129,383,373,505,195,305,133,459,339,389,15,215,47,209,65,445,429,295,335,461,365,171,413,265,143,217,371,439,69,355,477,97";
$res6o = "TreeMatch: 375,294,245,162,519,689,21,704,357,382,487,392,151,355,198,123,154,349,486,483,48,312,367,140,743,341,687,518,310,25,205,37,316,209,255,113,400,72,273,405,347,228,410,313,503,327,116,197,73,215,510,115,246,45,268,328,353,232,404,417,504,362,106,409,484,192,383,85,202,218,303,496,210,768,118,732,239,516,488,423,63,168,166,415,83,130,136,263,109,296,233,480,244,418,77,422,292,627,11,164,178,82,537,242,117,249,234,333,280,26,517,203,269,24,633,524,376,201,343,15,512,529,274,196,227,220,497,500,129,237,23,104,35,20,322,293,17,119,306,270,342,532,14,149,258,297,59,338,125,501,380,514,222,534,494,277,78,305,42,531,122,257,492,493,318,508,226,206,535,111,199,396,175,181,352,145,152,236,127,238,254,513,528,190,84,157,167,177,520,224,278,282,46,509,139,60,536,176,381,5,539,430,314,143,147,309,194,47,525,243,0,107,373,491,185,38,502,195,160,331,156,299,360,58,521,126,101,530,307,8,387,30,137,36,523,170,103,230,361,261,431,324,189,298,251,265,522,55,173,377,358,402,223,12,391,22,533,515,372,490,276,153,527,200,300,102,424,370,216,385,131,267,193,6,179,264,356,526,427,41,213,731,191,538,217,54,124,135,459,13,511,284,29,334,53,413,248,421,335,451,386,489,507,401,374,286,311,407,241,354,250,271,420,214,171,132,291,128,384,28,105,295,390,453,235,397,207,395,7,394,146,473,289,57,88,114,187,259,186,340,161,165,141,471,19,49,62,16,279,121,272,411,9,329,290,301,454,18,332,393,363,100,426,330,34,247,478,416,2,110,323,81,368,283,369,285,371,317,481,456,169,108,475,460,495,288,414,450,10,39,308,419,359,80,260,477,320,326,403,452,472,240,406,364,344,142,79,350,212,74,148,44,256,304,144,366,479,76,208,408,351,120,482,455,112,221,365,275,412,315,474,485,65,437,262,75,204,253,468,348,458,266,40,1,56,457,325,425,339,469,61,429,50,159,86,321,174,180,302,51,506,182,345,155,439,184,281,466,346,336,476,163,134,438,64,3,150,188,231,211,462,69,52,219,465,67,505,229,71,183,319,470,287,467,337,138,158,66,70,225,252,436,172,428,463,464,133,434,461,433,435,432";
$res8 = "TreeMatch: 214,508,356,510,178,136,284,282,472,30,418,436,224,98,406,80,354,342,419,482,96,126,118,470,222,92,137,176,278,122,184,440,120,86,160,438,276,338,170,106,78,274,430,127,190,468,322,400,339,74,174,490,336,332,72,434,116,330,107,480,364,416,58,466,414,432,220,428,200,84,168,82,90,478,320,68,476,272,318,114,218,426,496,388,34,452,352,270,198,216,331,212,357,422,340,115,148,420,450,524,260,35,380,448,323,314,500,378,374,258,210,201,73,123,421,312,208,206,372,194,460,192,66,401,526,76,70,40,204,410,254,64,292,285,408,149,268,321,404,256,373,166,195,196,368,217,124,62,154,41,522,402,94,164,502,518,366,362,188,464,81,308,100,101,162,191,527,412,60,252,407,306,398,158,117,156,316,411,152,477,161,461,193,4,429,250,497,186,360,514,520,396,302,150,328,300,381,187,523,248,474,230,130,140,246,242,286,303,228,449,20,498,16,240,110,462,71,287,494,382,251,50,392,125,506,153,108,492,405,390,504,516,353,441,376,18,458,484,393,386,231,14,262,51,12,456,202,290,22,209,138,8,95,134,6,255,165,403,17,241,519,317,132,207,182,459,10,232,180,488,453,304,433,28,261,457,473,244,280,334,88,69,5,377,181,291,155,2,61,135,175,48,266,384,56,0,315,44,385,273,505,319,442,277,215,54,279,52,446,146,13,257,45,75,19,310,144,205,486,267,65,509,7,177,501,307,413,394,29,487,247,326,172,112,444,491,26,369,27,93,495,525,471,133,264,97,219,269,521,104,171,431,391,435,145,183,211,265,379,437,417,109,281,383,288,337,313,481,24,253,409,370,142,397,143,49,221,121,213,167,427,59,229,465,503,173,389,245,451,463,243,423,139,371,387,324,102,469,9,179,327,447,53,233,350,141,367,346,89,42,197,333,309,363,157,119,424,341,87,467,347,38,483,203,439,77,31,67,348,131,425,415,39,395,271,43,185,344,226,343,475,305,335,21,259,493,15,11,147,227,301,36,512,46,445,103,399,159,169,289,443,128,351,355,489,111,375,507,79,32,325,511,3,1,499,25,225,263,485,91,151,113,57,85,283,199,365,275,517,129,163,479,55,361,33,329,47,105,249,515,189,349,23,37,83,223,513,311,63,293,345,99";
$res9 = "TreeMatch: 0,4,8,12,13,9,2,6,3,14,15,1,10,11,7,5";
$res10 = "TreeMatch: 0,1,8,9,11,10,4,5,6,13,15,2,12,14,7,3";

$res11 = "TreeMatch: 0,16,24,18,8,16,10,20,4,2,8,28,12,6,20,22,24,14,21,22,25,21,4,1,17,12,2,30,23,9,9,13,20,15,7,8,29,11,31,25,15,14,4,21,11,11,26,23,7,6,3,28,26,16,27,8,6,31,14,29,3,5,18,17,22,12,3,18,23,1,18,26,14,30,0,22,24,19,5,5,31,1,15,19,13,13,1,24,11,19,2,0,27,29,23,15,16,28,12,7,7,17,10,25,10,30,4,9,28,21,9,0,27,17,26,5,3,10,13,6,30,20,31,25,27,29,2,19";
$res12 = "TreeMatch: 0,2,1,8,16,9,17,4,12,5,18,24,25,13,0,21,27,28,29,19,3,6,14,6,8,27,7,31,26,20,22,31,4,24,11,16,2,23,20,9,26,30,12,17,23,21,22,19,11,13,1,5,29,25,14,18,15,10,28,15,3,10,30,7";
$res13 = "TreeMatch: 31,31,27,10,35,2,32,29,8,27,35,26,17,2,31,34,17,30,23,32,27,29,8,29,10,17,27,23,16,33,33,23,29,26,2,35,31,34,33,2,16,26,8,32,34,34,33,32,12,12,30,30,23,17,8,35,12,10,26,12,30,10,16,16";
$res14 = "TreeMatch: 30,10,35,8,26,10,27,12,29,31,26,32,17,29,12,2,35,16,12,2,35,12,29,30,10,17,31,33,2,26,26,17,12,16,29,26,32,27,33,35,16,16,29,12,27,27,34,2,29,29,30,32,34,10,34,26,29,33,16,32,30,31,8,10,2,17,31,8,2,30,8,34,16,33,30,2,35,8,31,31,33,30,16,8,17,17,30,35,27,8,31,30,34,32,2,16,10,32,17,29,31,10,27,35,27,33,27,26,32,12,26,27,34,10,34,31,26,16,17,17,33,12,33,35,34,32,23,8";
$res15 = "TreeMatch: 6,9,7,15,15,6,11,0,7,15,15,6,0,14,9,9,0,7,0,11,11,7,14,11,9,13,13,13,6,14,14,13";
$res16 = "TreeMatch: 6,11,7,14,14,6,9,0,7,14,14,6,0,15,11,11,0,7,0,9,9,7,15,9,11,13,13,13,6,15,15,13";
$res1s = "TreeMatch: 337,331,369,271,345,311,334,325,329,318,307,272,215,212,305,257,388,217,324,258,385,303,309,335,354,236,338,370,218,387,349,299,326,297,210,346,395,233,254,366,357,255,328,304,234,213,375,239,211,232,295,251,394,330,359,327,372,293,237,397,274,252,291,373,279,216,296,290,238,315,270,393,256,350,317,259,389,352,332,312,273,316,277,376,276,278,336,368,214,353,319,355,399,396,219,358,310,292,235,231,230,390,333,386,313,351,308,367,250,323,348,356,379,391,374,253,275,314,298,392,371,306,294,365,398,377,339,378";
$res2s = "TreeMatch: 41,43,34,30,56,62,5,51,29,44,48,8,7,39,40,16,14,53,11,13,36,59,21,58,31,15,26,19,1,25,33,18,50,9,54,57,42,2,24,63,0,61,28,4,3,17,32,12,55,38,35,45,10,6,20,49,47,23,52,46,37,22,60,27";
$res3s = "TreeMatch: 239,215,6,36,2,228,173,203,126,137,98,37,9,164,165,104,11,56,66,75,14,135,69,13,180,33,196,219,102,177,153,194,63,58,95,136,74,19,8,73,50,16,209,167,217,59,211,110,117,226,62,229,187,247,90,178,100,0,105,86,212,61,44,17,65,168,162,12,34,142,4,250,48,96,216,227,97,112,140,240,40,72,26,248,148,91,166,38,27,20,169,99,89,224,70,18,55,77,1,252,93,152,150,188,21,79,101,145,201,3,35,42,122,5,109,149,170,147,83,67,128,206,32,30,82,234,242,25,218,246,186,172,106,29,81,23,31,134,71,121,115,183,151,232,46,52,176,123,195,57,129,120,191,119,124,111,207,159,116,205,114,47,28,60,7,249,76,230,118,254,87,197,174,132,68,200,181,223,236,108,45,160,238,241,133,244,139,54,171,49,175,193,251,222,235,143,182,208,161,225,190,185,255,85,64,78,92,189,202,24,113,158,231,141,53,192,210,144,94,154,131,213,253,233,163,84,199,127,103,237,22,146,184,39,204,179,88,107,221,198,80,51,41,245,155,243,43,214,156,138,125,10,15,130,157,220";
$res4s = "TreeMatch: 975,966,1003,980,1005,1009,989,984,976,1017,1007,960,999,1014,974,973,996,1023,994,991,1019,986,978,987,981,997,971,992,963,968,1000,993,985,961,1011,1004,967,964,969,1008,962,1021,977,988,965,972,1001,990,1010,1015,1002,1016,995,998,979,1006,1012,983,1022,1013,1018,982,1020,970";
$res5s = "TreeMatch: 3,0,5,2,4,6,1,7";
$res1sb = "TreeMatch: 26,8,10,31,30,23,34,16,35,33,32,27,12,2,17,29";
#$res2sb = "TreeMatch: 243,273,243,434,633,150,534,415,257,268,124,327,173,456,168,485,362,464,476,356,203,230,157,278,425,436,119,277,88,459,154,355,104,465,239,237,216,125,201,220,281,454,82,58,410,76,270,426,260,55,288,129,349,330,196,135,35,488,376,174,390,100,225,176,528,204,233,45,387,105,329,47,689,274,432,477,269,380,158,289,74,404,138,310,175,422,438,139,354,450,421,10,529,417,177,61,433,59,471,533,484,490,209,46,743,406,161,71,502,316,463,480,152,520,12,335,228,279,266,275,83,494,222,318,511,234,412,731,155,223,522,300,181,191,118,507,451,377,22,512,341,212,368,166,467,402,287,290,350,128,44,384,478,325,343,206,293,265,103,295,112,361,419,382,39,405,704,29,439,130,198,140,363,25,244,106,72,340,299,437,517,111,77,26,19,323,78,296,491,16,52,172,411,627,224,509,159,117,255,482,272,535,70,374,162,385,521,373,15,123,481,202,319,407,271,298,11,313,364,226,468,338,235,370,215,312,501,134,428,457,101,291,479,303,531,395,231,210,253,192,249,504,54,532,396,431,263,337,229,358,13,3,199,145,342,73,284,185,7,114,530,487,189,160,435,321,430,283,336,131,345,500,252,392,24,186,141,40,60,339,420,38,391,418,453,37,525,527,424,306,247,413,242,429,132,156,360,200,184,514,416,142,768,30,353,458,359,147,62,146,259,472,167,307,1,489,282,53,523,333,469,369,165,236,20,515,23,195,102,148,251,393,328,17,510,286,169,144,187,320,516,309,120,261,80,308,108,136,218,409,240,513,127,297,115,14,207,506,381,258,357,474,164,304,314,503,171,50,397,219,386,28,213,346,276,254,211,408,322,394,190,188,241,137,331,475,538,79,460,113,18,375,302,205,505,347,163,180,85,315,42,401,110,6,473,461,280,267,66,414,221,84,536,526,317,107,687,486,48,311,217,214,372,466,143,122,294,36,400,351,153,519,495,537,238,462,427,64,81,496,470,56,232,455,301,518,183,170,250,116,197,227,326,492,57,285,178,539,151,208,483,348,365,493,334,248,264,9,344,0,452,179,63,497,109,41,193,524,383,352,332,149,75,366,262,324,508,21,367,121,256,403,86,8,2,133,423,182,246,51,292,49,65,67,732,126,34,305,69,371,245,5";
$res3sb = "TreeMatch: 23,26,2,35,34,12,16,31,17,33,32,29,10,8,30,27";
$res4sb = "TreeMatch: 2,23,8,17,16,10,35,30,34,27,26,29,32,33,31,12";
#$res5sb = "TreeMatch: 132,132,377,326,311,11,211,430,385,732,163,493,376,419,316,412,72,439,453,497,128,154,112,466,271,199,689,345,369,138,312,500,283,167,223,349,456,162,146,204,373,268,353,174,486,307,130,284,408,299,400,67,336,435,386,26,161,277,450,168,144,212,262,123,372,480,474,25,127,282,110,633,51,190,295,452,704,171,79,401,281,429,318,107,169,391,197,319,501,394,396,176,116,246,111,301,293,175,534,228,308,426,221,627,178,140,83,122,346,153,438,425,524,437,320,323,12,467,218,191,333,352,458,337,393,475,244,297,313,459,36,29,149,194,104,233,395,433,314,415,225,142,239,159,454,506,407,404,538,483,24,494,464,255,365,342,226,368,250,254,332,8,251,213,528,428,109,768,461,80,156,46,185,173,463,48,126,124,743,198,416,334,306,531,137,479,304,88,427,15,35,121,484,232,263,235,468,113,164,267,327,210,530,55,103,495,436,229,519,527,424,129,329,141,131,731,182,367,117,257,341,231,73,108,264,366,533,30,287,286,78,405,465,60,180,53,155,150,358,330,339,687,298,64,217,292,473,481,13,509,321,134,157,360,364,249,403,0,41,102,177,413,205,82,431,537,420,186,485,81,520,179,85,348,328,65,47,58,300,230,397,513,145,240,261,291,374,70,270,357,184,227,133,421,382,74,9,147,1,310,242,359,115,273,215,139,508,234,471,75,411,490,158,118,6,276,187,34,37,351,202,238,5,340,515,309,315,516,105,248,207,77,243,14,392,406,317,120,66,536,417,489,302,409,289,488,39,19,42,487,2,414,354,491,106,518,343,510,170,410,507,477,17,325,54,361,62,259,216,49,383,172,143,522,188,517,151,432,478,52,195,347,3,18,434,476,100,305,422,356,136,451,61,482,503,523,241,148,192,165,324,237,335,40,362,423,203,219,84,492,344,196,370,71,152,16,50,418,23,119,457,265,247,455,504,526,252,290,245,539,525,278,166,380,222,294,285,21,288,183,532,355,472,269,28,279,274,63,206,363,387,256,496,56,86,402,200,371,10,220,266,76,189,57,322,338,253,44,521,7,260,201,470,69,38,59,331,375,505,214,350,125,280,209,193,208,101,514,502,303,384,511,535,45,135,381,390,275,460,258,224,22,20,469,296,114,272,181,529,236,462,160";




$nb_tests = 0;
$nb_fails = 0;
printf "Testing tleaf...\n";
$nb_fails += test_tm($ex1,$res1);
$nb_tests++;
$nb_fails += test_tm($ex2,$res2);
$nb_tests++;
$nb_fails += test_tm($ex1o,$res1o);
$nb_tests++;
$nb_fails += test_tm($ex2o,$res2o);
$nb_tests++;

printf "\nTesting xml/hwloc input...\n";
$nb_fails += test_tm($ex3,$res3);
$nb_tests++;
$nb_fails += test_tm($ex3l,$res3l);
$nb_tests++;
$nb_fails += test_tm($ex4,$res4);
$nb_tests++;
$nb_fails += test_tm($ex4l,$res4l);
$nb_tests++;
$nb_fails += test_tm($ex3o,$res3o);
$nb_tests++;
$nb_fails += test_tm($ex4o,$res4o);
$nb_tests++;

printf "\nTesting large input...\n";
$nb_fails += test_tm($ex5,$res5);
$nb_tests++;
$nb_fails += test_tm($ex6,$res6);
$nb_tests++;
$nb_fails += test_tm($ex5o,$res5o);
$nb_tests++;
$nb_fails += test_tm($ex6o,$res6o);
$nb_tests++;
$nb_fails += test_tm($ex7,$res7);
$nb_tests++;
$nb_fails += test_tm($ex8,$res8);
$nb_tests++;

printf "\nTesting underscubscribing...\n";
$nb_fails += test_tm($ex9,$res9);
$nb_tests++;
$nb_fails += test_tm($ex10,$res10);
$nb_tests++;

printf "\nTesting overderscubscribing...\n";
$nb_fails += test_tm($ex11,$res11);
$nb_tests++;
$nb_fails += test_tm($ex12,$res12);
$nb_tests++;
$nb_fails += test_tm($ex13,$res13);
$nb_tests++;
$nb_fails += test_tm($ex14,$res14);
$nb_tests++;
$nb_fails += test_tm($ex15,$res15);
$nb_tests++;
$nb_fails += test_tm($ex16,$res16);
$nb_tests++;

if (have_scotch()) {
    printf "\nTesting Scotch features...\n";
    $nb_fails += test_tm($ex1s,$res1s);
    $nb_tests++;
    $nb_fails += test_tm($ex2s,$res2s);
    $nb_tests++;
    $nb_fails += test_tm($ex3s,$res3s);
    $nb_tests++;
    $nb_fails += test_tm($ex4s,$res4s);
    $nb_tests++;
    $nb_fails += test_tm($ex5s,$res5s);
    $nb_tests++;
    printf "\nTesting Constraints with Scotch...\n";
    $nb_fails += test_tm($ex1sb,$res1sb);
    $nb_tests++;
    # $nb_fails += test_tm($ex2sb,$res2sb);
    # $nb_tests++;
    $nb_fails += test_tm($ex3sb,$res3sb);
    $nb_tests++;
    $nb_fails += test_tm($ex4sb,$res4sb);
    $nb_tests++;
    # $nb_fails += test_tm($ex5sb,$res5sb);
    # $nb_tests++;
}


if(!$nb_fails){
   print_color('bold green', "\n\tAll $nb_tests tests passed!\n");
   exit(0);
}else{
   if($nb_fails == 1){
      print_color('bold red', "\n\tERROR: $nb_fails/$nb_tests test failed!\n");
   }else{
      print_color('bold red', "\n\tERROR: $nb_fails/$nb_tests tests failed!\n");
   }
   exit(-1);
}

sub test_tm{
   my ($ex,$res)=@_;
   $str_len = length($mapping) + 3 * length ($path);
   $spaces = 100+int($str_len/9)*9;
   $string = "%-".$spaces."s";
   printf  $string, $ex;

   @output= `$ex`;

   # print "\n$ex";
   # print "\no: ";
   # print @output;
   # print "r: $res\n";

   foreach $line (@output){
       if ($line=~m/^$res/){
	   print_color('bold green', " PASSED");
	   return 0;
       }
   }
   print_color('bold red', " FAILED");
}

sub test_tm_metric_scotch{
    my ($ex,$res)=@_;
    $str_len = length($mapping) + 3 * length ($path);
    $spaces = 100+int($str_len/9)*9;
    $string = "%-".$spaces."s";
    printf  $string, $ex;

    @output= `$ex`;

    # print"\n";
    $res=~ s/\n/ /g;
    $out = sprintf "@output";
    $out =~ s/\n//g;
    # print "r: $res\n";
    # print "o: $out\n";
    if ($out eq $res){
       print_color('bold green', " PASSED");
       return 0;
    }
    print_color('bold red', " FAILED");    
}

sub print_color{
   my ($color,$text)=@_;
   if($color_enable){
      print color($color);
      print ("$text\n");
      print color('reset');
   }else{
      print("$text\n");
   }
}

sub have_scotch{
   my @lines = `$mapping 2>&1`;
   for my $line (@lines) {
      if ($line =~ /is compiled with Scotch/) {
	 return  1;
      }
   } 
   return 0;
}
